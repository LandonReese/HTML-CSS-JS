<html>
    <head>
        <script>
            // 1. List the pets available for adoption 
            // 2. Get details for one specific pet (from the prior list) 
            // 3. Adopt one pet, i.e. delete it such that it no longer appears on the list from #1  The “B” version (graded from 90 points max) requirements include everything above plus: 
            // 4. The ability to update the details (except for the name) of one pet
            // 5. The ability to add new pets
            // 
            // Tasks Completed:
            // 1, 2, 
        </script>

        <script>
            // Creates a list of pets, and then calls populateList
            function loadList(thendo){
                fetch("http://localhost:8000/")
                .then((r) => r.text())
                .then((d) => {
                    console.log(d);
                    var pets = JSON.parse(d); // returns an array
                    thendo(pets); //thendo acts as populateList(pet)
                });
            } 

            // Fills the unordered list "petList" with all pets
            function populateList(pets){
                var petList = document.getElementById("petList");
                petList.innerHTML = "";

                    for(var pet of pets) {
                        console.log(pet);
                        var listItem = document.createElement("li");
                        listItem.innerHTML = pet;
                        listItem.onclick = populateLinks(pet);
                        petList.appendChild(listItem);
                    }
            }


            function populateLinks(pet){
                console.log(pet);
                var pL = document.getElementById("petLinks");
                pL.innerHTML = "";
                var petLink = document.createElement("a");
                petLink.innerHTML = "Get details about " + pet + ". ";
                petLink.href = "http://localhost:8000/" + pet;
                pL.appendChild(petLink);
            }
            
            function setPetName(){
                var input = document.getElementById("petInputText");
                var textToUpdate = document.getElementById("petInput");
                textToUpdate.innerHTML = "";
                textToUpdate.innerHTML = input.value;
            }

            function deletePet(pet){
                fetch("http://localhost:8000/" + pet, {
                    method: 'DELETE'
                })
                .then(response => {
                    if (response.ok) {
                        console.log(pet + ' has been deleted successfully');
                    } else {
                        console.error('Failed to delete ' + pet);
                    }
                })
            }

        </script>
    </head>
    
    <body>
        <h1>Pets Available</h1>
        <p><button id="myButton" onclick="loadList(populateList)">Load Pet Information</button></p>
        
        <ul id="petList"></ul>
        <ul id="petLinks"></ul>

        <label for="petInputText">Enter the pet name to delete:</label>
        <input type="text" id="petInputText">
        <p><button id="petToDelete" onclick="setPetName()">Update Name</button></p>

        <p id="petInput">Pet name to delete</p>
        <p><button id="deleteButton" onclick="deletePet(petInput.innerHTML)">Delete pet</button></p>


        <script>
            // var petList = document.getElementById("petList");
            // for(var i = 0; i < petList.length; i++){
            //     var currentItem = myArray[i];
			//     var listItem = document.createElement("li");
			//     listItem.textContent = "Name: " + currentItem.name + ", Age: " + currentItem.age;
			//     myList.appendChild(listItem);
            // }
         
    
            // Patch to update, delete to delete, put to add new pets, could use post to create a new pet
            // app.get('/', (req, res) => {res.json("Welcome to the Pet REST Server!")})
            // under the ~ exists the back-tick
            //`${id_name}` 
            // Write an HTML based front end to interact with the PET Rest Server
            // const express = require('express');
            // var app = express(); need for creating a server
            // app.get('/', (req, res) => {res.json("Welcome to the Pet REST Server!")})
            // app.listen(3000); need for getting input from server?
        </script>
    </body>
</html>